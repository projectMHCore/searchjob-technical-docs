# Lab5 - Test-Case для тестування валідації паролю

## Test Case Information

**ID:** TC_REG_PWD_001

**Priority:** High (Висока)

**Requirement:** REQ-AUTH-002 "Система повинна перевіряти коректність та співпадіння паролів при реєстрації користувача"

**Module/Component:** Authentication Module / RegisterController (Модуль автентифікації / Контролер реєстрації)

**Title:** Тестування валідації пароля та підтвердження пароля при реєстрації нового користувача в системі SearchJob

---

## Preconditions (Передумови)

- Веб-сервер запущений та доступний за адресою localhost
- MySQL база даних підключена та налаштована 
- Додаток SearchJob запущений та працює коректно
- Браузер відкритий та має доступ до інтернету
- Форма реєстрації (register.php) завантажується без помилок
- Тестовий користувач з email "test@example.com" та логіном "testuser123" відсутній в базі даних
- Сесії та кукі очищені

---

## Steps (Кроки тестування) та Expected Results (Очікувані результати)

### Тест-сценарій 1: Успішна реєстрація з валідними паролями

**Step 1:** Відкрити форму реєстрації
- Дія: Відкрити браузер та перейти на URL: `http://localhost/frontend/register.php`
- **Expected Result:** Форма реєстрації відображається з полями: логін, email, пароль, підтвердження пароля, роль. Всі поля порожні та готові для введення даних.

**Step 2:** Заповнити поле логіну
- Дія: Ввести в поле "login": `testuser123`
- **Expected Result:** Поле заповнене текстом "testuser123", без помилок валідації або попереджень.

**Step 3:** Заповнити поле email
- Дія: Ввести в поле "email": `test@example.com`
- **Expected Result:** Поле заповнене валідним email форматом, без помилок валідації.

**Step 4:** Ввести пароль
- Дія: Ввести в поле "password": `MySecurePass123!`
- **Expected Result:** Поле заповнене, текст пароля прихований символами •••••••••••••••

**Step 5:** Ввести підтвердження пароля (співпадіння)
- Дія: Ввести в поле "confirm_password": `MySecurePass123!`
- **Expected Result:** Поле заповнене, паролі повністю співпадають, без попереджень про неспівпадіння.

**Step 6:** Вибрати роль користувача
- Дія: Обрати з випадаючого списку "role": `job_seeker`
- **Expected Result:** Роль обрана, відображається як "Шукач роботи".

**Step 7:** Відправити форму реєстрації
- Дія: Натиснути кнопку "Зареєструватися"
- **Expected Result:** Успішна реєстрація, перенаправлення на `register.php?success=registered` з повідомленням "Користувач успішно зареєстрований!"

---

### Тест-сценарій 2: Помилка валідації - неспівпадіння паролів

**Step 8:** Відкрити нову форму реєстрації
- Дія: Оновити сторінку register.php для нового тестування
- **Expected Result:** Форма очищена та готова для нових даних.

**Step 9-11:** Заповнити базові поля
- Дія: Ввести логін: `testuser456`, email: `test2@example.com`, роль: `job_seeker`
- **Expected Result:** Всі поля коректно заповнені.

**Step 12:** Ввести пароль
- Дія: Ввести в поле "password": `Password123`
- **Expected Result:** Поле заповнене та приховано символами.

**Step 13:** Ввести неспівпадаючий пароль підтвердження
- Дія: Ввести в поле "confirm_password": `Password124`
- **Expected Result:** Поле заповнене, але значення відрізняється від основного пароля.

**Step 14:** Відправити форму з неспівпадаючими паролями
- Дія: Натиснути кнопку "Зареєструватися"
- **Expected Result:** Помилка валідації: "Пароли не совпадают!", перенаправлення на `register.php?error=Пароли не совпадают!`, користувач НЕ створений в базі даних.

---

### Тест-сценарій 3: Помилка валідації - порожній пароль

**Step 15:** Відкрити нову форму реєстрації
- Дія: Оновити сторінку для третього тестування
- **Expected Result:** Форма очищена.

**Step 16-17:** Заповнити базові поля
- Дія: Ввести логін: `testuser789`, email: `test3@example.com`
- **Expected Result:** Поля коректно заповнені.

**Step 18:** Залишити пароль порожнім
- Дія: Не вводити нічого в поле "password" (залишити порожнім)
- **Expected Result:** Поле залишається порожнім.

**Step 19:** Ввести підтвердження пароля
- Дія: Ввести в поле "confirm_password": `somepassword`
- **Expected Result:** Поле підтвердження заповнене.

**Step 20:** Відправити форму з порожнім паролем
- Дія: Натиснути кнопку "Зареєструватися"
- **Expected Result:** Помилка валідації: "Заполните все обязательные поля!", перенаправлення на `register.php?error=...`, користувач НЕ створений.

---

### Тест-сценарій 4: Помилка валідації - порожнє підтвердження пароля

**Step 21:** Відкрити нову форму реєстрації
- Дія: Оновити сторінку для четвертого тестування
- **Expected Result:** Форма очищена.

**Step 22-23:** Заповнити базові поля
- Дія: Ввести логін: `testuser000`, email: `test4@example.com`
- **Expected Result:** Поля коректно заповнені.

**Step 24:** Ввести пароль
- Дія: Ввести в поле "password": `ValidPass123`
- **Expected Result:** Поле заповнене та приховано.

**Step 25:** Залишити підтвердження порожнім
- Дія: Не вводити нічого в поле "confirm_password"
- **Expected Result:** Поле підтвердження залишається порожнім.

**Step 26:** Відправити форму з порожнім підтвердженням
- Дія: Натиснути кнопку "Зареєструватися"
- **Expected Result:** Помилка валідації: "Пароли не совпадают!", перенаправлення на `register.php?error=...`, користувач НЕ створений.

---

## Технічні деталі валідації

### Код валідації з RegisterController.php:
```php
// Перевірка заповнення всіх полів
if (!$login || !$password || !$email) {
    $error = 'Заполните все обязательные поля!';
}
// Перевірка співпадіння паролів  
elseif ($password !== $confirm_password) {
    $error = 'Пароли не совпадают!';
}
```

### Логіка обробки помилок:
```php
// Очищаємо буфер перед редиректом
ob_end_clean();
// Передаємо помилку назад на форму
header('Location: register.php?error=' . urlencode($error));
exit;
```

### Успішна реєстрація:
```php
if ($result['success']) {
    ob_end_clean(); // Очищуємо буфер перед редиректом
    header('Location: register.php?success=registered');
    exit;
}
```

---

## Тестові дані

### Валідні тестові дані:
- Логін: testuser123, user2024, jobseeker_test
- Email: test@example.com, user@company.org, seeker@job.net  
- Пароль: MySecurePass123!, TestPassword2024, JobSeeker@123
- Роль: job_seeker, employer

### Невалідні тестові дані:
- Неспівпадаючі паролі: "Password123" / "Password124"
- Порожні поля: "" / "somepassword"
- Спеціальні символи: "Pass<script>" / "Pass<script>"

---

## Очікувані результати по кроках

### Позитивний сценарій (кроки 1-6):
- Форма відправляється успішно
- Користувач створений в базі даних
- Перенаправлення на register.php?success=registered
- Відображається повідомлення про успішну реєстрацію

### Негативний сценарій - неспівпадіння (кроки 7-10):
- Валідація спрацьовує на серверній стороні
- Генерується помилка "Пароли не совпадают!"
- Перенаправлення на register.php?error=Пароли не совпадают!
- Форма відображається з повідомленням про помилку

### Негативний сценарій - порожні поля (кроки 11-18):
- Валідація виявляє порожні обов'язкові поля
- Генерується помилка "Заполните все обязательные поля!"
- Користувач залишається на формі для виправлення

---

## Postconditions (Пост-умови)

### Стан системи після виконання тесту:

**При успішному проходженні (позитивний сценарій):**
- Новий користувач створений в таблиці `users` бази даних з усіма обов'язковими полями
- Пароль захешований за допомогою `password_hash()` та безпечно збережений
- Email та логін користувача унікальні в системі
- Статус користувача встановлений як активний
- Запис про реєстрацію створений з поточним timestamp
- Користувач може успішно авторизуватися з введеними credentials

**При невдалому проходженні (негативні сценарії):**
- Жодного нового користувача не створено в базі даних
- Цілісність даних збережена - немає некоректних записів
- Відображено відповідне повідомлення про помилку користувачу
- URL містить параметр error з описом проблеми
- Форма реєстрації залишається доступною для повторної спроби

### Процедури очищення після тестування:

1. **Очищення тестових даних:**
   ```sql
   DELETE FROM users WHERE email IN ('test@example.com', 'test2@example.com', 'test3@example.com', 'test4@example.com');
   DELETE FROM users WHERE login IN ('testuser123', 'testuser456', 'testuser789', 'testuser000');
   ```

2. **Очищення сесій та кешу:**
   - Очистити всі PHP сесії: `session_destroy()`
   - Очистити cookies браузера
   - Перезавантажити сторінку для повернення в початковий стан

3. **Перевірка стану системи:**
   - Перевірити лог-файли сервера на наявність критичних помилок
   - Переконатися, що база даних не містить тестових записів
   - Перевірити, що всі файли системи залишилися незмінними

4. **Відновлення початкового стану:**
   - База даних не містить тестових користувачів
   - Лічильники та індекси в нормальному стані
   - Система готова для наступного циклу тестування

---

## Критерії проходження тесту

### Статуси тестування:

**✅ ПРОЙШОВ (PASSED)** - якщо:
- Всі кроки виконуються згідно з очікуваними результатами
- Позитивний сценарій завершується успішною реєстрацією
- Негативні сценарії коректно відхиляють невалідні дані
- База даних містить/не містить записи згідно з очікуваннями
- Повідомлення про помилки відображаються коректно

**❌ НЕ ПРОЙШОВ (FAILED)** - якщо:
- Хоча б один крок відрізняється від очікуваного результату
- Валідація не спрацьовує при невалідних даних
- Користувач створюється при помилках валідації
- Некоректні повідомлення про помилки або відсутність таких
- Система реагує непередбачувано на тестові дані

**⚠️ ЗАБЛОКОВАНИЙ (BLOCKED)** - якщо:
- Веб-сервер недоступний або не відповідає
- База даних недоступна або містить критичні помилки
- Форма реєстрації не завантажується
- Критичні помилки PHP що блокують виконання
- Зовнішні залежності недоступні

### Метрики якості:
- **Покриття тестами:** 100% сценаріїв валідації паролів
- **Час виконання:** ≤ 5 хвилин для повного тест-сету
- **Стабільність:** Тест повинен проходити 10/10 разів

---

## Додаткові перевірки та валідація

### 1. Перевірки в базі даних:
```sql
-- Перевірка створення користувача
SELECT * FROM users WHERE email = 'test@example.com';
SELECT * FROM users WHERE login = 'testuser123';

-- Перевірка хешування пароля
SELECT login, password FROM users WHERE email = 'test@example.com';
-- Пароль повинен бути захешований, НЕ в відкритому вигляді
```

### 2. Перевірка логів системи:
- **PHP Error Log:** Переглянути на наявність критичних помилок
- **Apache/Nginx Access Log:** Перевірити HTTP статус коди (200, 302)
- **MySQL Error Log:** Переконатися у відсутності помилок БД

### 3. Перевірка безпеки:
- Пароль ніколи не передається в URL параметрах
- Паролі в БД завжди захешовані
- Немає SQL ін'єкцій при введенні спеціальних символів
- XSS захист працює при введенні HTML тегів

### 4. Перевірка користувацького досвіду:
- Повідомлення про помилки зрозумілі та інформативні
- Форма зберігає введені дані при помилці (крім паролів)
- Час відгуку форми ≤ 3 секунд
- Інтерфейс працює коректно в різних браузерах

### 5. Тест продуктивності:
- Одночасна реєстрація 10 користувачів
- Навантажувальний тест з 100 запитами
- Перевірка використання пам'яті сервера

---

## Тестове оточення

### Системні вимоги:
- **ОС:** Windows 10/11, Ubuntu 20.04+ або macOS 12+
- **Веб-сервер:** Apache 2.4+ або Nginx 1.18+
- **PHP:** версія 7.4+ з підтримкою mysqli
- **MySQL:** версія 8.0+ або MariaDB 10.4+
- **Браузер:** Chrome 90+, Firefox 88+, Safari 14+

### Конфігурація додатку:
- **URL додатку:** http://localhost/frontend/
- **Шлях до реєстрації:** http://localhost/frontend/register.php
- **База даних:** searchjob_db
- **Таблиця користувачів:** users
- **Кодування:** UTF-8

### Підготовка оточення:
1. Запустити локальний веб-сервер (XAMPP/WAMP/MAMP)
2. Імпортувати схему бази даних
3. Перевірити підключення до MySQL
4. Очистити кеш браузера та cookies
5. Переконатися у доступності всіх файлів проекту

---

Дата створення: 2024-12-19  
Дата останнього оновлення: 2024-12-19  
Версія тест-кейсу: 2.0  
Автор: QA Team  
Статус: ✅ Готовий до виконання  
Час виконання: ~15 хвилин  
Складність: Середня
